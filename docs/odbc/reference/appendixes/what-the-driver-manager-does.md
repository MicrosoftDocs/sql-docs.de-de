---
description: Funktionen des Treiber-Managers
title: Funktionsweise des Treiber-Managers | Microsoft-Dokumentation
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: reference
helpviewer_keywords:
- driver manager [ODBC], backward compatibility
- compatibility [ODBC], driver manager
- ODBC driver manager [ODBC]
- backward compatibility [ODBC], driver manager
ms.assetid: 57f65c38-d9ee-46c8-9051-128224a582c6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: d210d5c202f11151cf22a64362b652958422f513
ms.sourcegitcommit: 33f0f190f962059826e002be165a2bef4f9e350c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/30/2021
ms.locfileid: "99158163"
---
# <a name="what-the-driver-manager-does"></a>Funktionen des Treiber-Managers
In der folgenden Tabelle wird zusammengefasst, wie der ODBC *3. x* -Treiber-Manager Aufrufe an ODBC *2. x* -und ODBC *3. x* -Treiber zuordnet.  
  
|Funktion oder<br /><br /> Anweisungsattribut|Kommentare|  
|-----------------------------------------|--------------|  
|SQL_ATTR_FETCH_BOOKMARK_PTR|Verweist auf das Lesezeichen, das mit **SQLFetchScroll** verwendet werden soll. Im folgenden finden Sie Implementierungsdetails:<br /><br /> Wenn eine Anwendung diese in einem ODBC *2. x* -Treiber festlegt, speichert Sie der ODBC *3. x* -Treiber-Manager zwischen. Der Zeiger dereferenziert den Zeiger und übergibt den Wert an den ODBC *2. x* -Treiber im *FetchOffset* -Argument von **sqlextendecodfetch** , wenn **SQLFetchScroll** später von der Anwendung aufgerufen wird.<br />Wenn eine Anwendung diese in einem ODBC *3. x* -Treiber festlegt, übergibt der ODBC *3. x* -Treiber-Manager den-Befehl an den Treiber.|  
|SQL_ATTR_ROW_STATUS_PTR|Verweist auf das Zeilen Status Array, das von **SQLFetch**, **SQLFetchScroll**, **SQLBulkOperations** und **SQLSetPos** ausgefüllt wird. Im folgenden finden Sie Implementierungsdetails:<br /><br /> Wenn diese in einer Anwendung in einem ODBC *2. x* -Treiber festgelegt wird, speichert der ODBC *3. x* -Treiber-Manager den zugehörigen Wert. Er übergibt diesen Wert an den ODBC *2. x* -Treiber im *rowstatus Array* -Argument von **sqlextendecodfetch** , wenn **SQLFetchScroll** oder **SQLFetch** aufgerufen wird.<br />Wenn eine Anwendung diese in einem ODBC *3. x* -Treiber festlegt, übergibt der ODBC *3. x* -Treiber-Manager den-Befehl an den Treiber.<br />-In Bundesstaat S6 wird, wenn eine Anwendung SQL_ATTR_ROW_STATUS_PTR festlegt und dann **SQLBulkOperations** (mit einem *Vorgang* von SQL_ADD) oder **SQLSetPos** aufruft, ohne zuerst **SQLFetch** oder **SQLFetchScroll** aufzurufen, wird SQLSTATE HY011 (das Attribut kann jetzt nicht festgelegt werden) zurückgegeben.|  
|SQL_ATTR_ROWS_FETCHED_PTR|Verweist auf den Puffer, in dem **SQLFetch** und **SQLFetchScroll** die Anzahl der abgerufenen Zeilen zurückgeben. Im folgenden finden Sie Implementierungsdetails:<br /><br /> Wenn diese in einer Anwendung in einem ODBC *2. x* -Treiber festgelegt wird, speichert der ODBC *3. x* -Treiber-Manager den zugehörigen Wert. Dieser Wert wird an den ODBC *2. x* -Treiber im *rowzähltptr* -Argument von **sqlextendecodfetch** übergeben, wenn **SQLFetch** oder **SQLFetchScroll** von der Anwendung aufgerufen wird.<br />Wenn eine Anwendung diese in einem ODBC *3. x* -Treiber festlegt, übergibt der ODBC *3. x* -Treiber-Manager den-Befehl an den Treiber.|  
|SQL_ATTR_ROW_ARRAY_SIZE|Legt die Rowsetgröße fest. Im folgenden finden Sie Implementierungsdetails:<br /><br /> Wenn diese in einer Anwendung in einem ODBC *2. x* -Treiber festgelegt wird, ordnet der ODBC *3. x* -Treiber-Manager Sie dem SQL_ROWSET_SIZE-Anweisungs Attribut zu.<br />Wenn eine Anwendung diese in einem ODBC *3. x* -Treiber festlegt, übergibt der ODBC *3. x* -Treiber-Manager den-Befehl an den Treiber.<br />: Wenn eine Anwendung, die mit einem ODBC *3. x* -Treiber arbeitet, **SQLSetScrollOptions** aufruft, wird SQL_ROWSET_SIZE auf den Wert im *rowsetsize* -Argument festgelegt, wenn der zugrunde liegende Treiber **SQLSetScrollOptions** nicht unterstützt.|  
|SQL_ROWSET_SIZE|Legt die Rowsetgröße fest, die von **sqlextendecodfetch** verwendet wird, wenn **sqlextendecodfetch** von einer ODBC *2. x* -Anwendung aufgerufen wird. Im folgenden finden Sie Implementierungsdetails:<br /><br /> : Wenn eine Anwendung dies festlegt, übergibt der ODBC *3. x* -Treiber-Manager den-Befehl unabhängig von der Treiber Version an den Treiber.<br />: Wenn eine Anwendung, die mit einem ODBC *2. x* -Treiber arbeitet, **SQLSetScrollOptions** aufruft, wird SQL_ROWSET_SIZE auf den Wert im **rowsetsize** -Argument festgelegt.|  
|**SQLBulkOperations**|Führt einen Einfügevorgang oder Update, DELETE oder Fetch von Lesezeichen Vorgängen aus. Im folgenden finden Sie Implementierungsdetails:<br /><br /> Wenn eine Anwendung **SQLBulkOperations** mit einem *Vorgang* von SQL_ADD in einem ODBC *2. x* -Treiber aufruft, ordnet der ODBC *3. x* -Treiber-Manager Sie **SQLSetPos** mit einem SQL_ADD *Vorgang* zu.<br />-Bei Verwendung eines ODBC *2. x* -Treibers, der **SQLSetPos** nicht mit einem *SQL_ADD Vorgang* unterstützt, ordnet der ODBC *3. x* -Treiber- **Manager SQLSetPos** mit einem *Vorgang von SQL_ADD* nicht zu **SQLBulkOperations** mit einem *Vorgang* von SQL_ADD zu. Dies liegt daran, dass **SQLBulkOperations** nicht im Status "S7" aufgerufen werden kann, was in ODBC *2. x* der einzige Zustand war, in dem **SQLSetPos** aufgerufen werden konnte.<br />: Wenn die Anwendung **SQLBulkOperations** mit einem *Vorgang* SQL_ADD in einem ODBC *2. x* -Treiber aufruft, bevor **SQLFetchScroll** aufgerufen wird, gibt der ODBC *3. x* -Treiber-Manager einen Fehler zurück.|  
|**SQLExtendedFetch**|Gibt das angegebene Rowset zurück. Mit Ausnahme der soeben notierten Einschränkung übergibt der ODBC *3. x* -Treiber-Manager Aufrufe an **SQLExtendedFetch** unabhängig von der Treiber Version an den Treiber.|  
|**SQLFetch**|Gibt das nächste Rowset zurück. Im folgenden finden Sie Implementierungsdetails:<br /><br /> : Wenn eine Anwendung **SQLFetch** in einem ODBC *2. x* -Treiber aufruft, ordnet der ODBC *3. x* -Treiber-Manager Sie **SQLExtendedFetch** zu. Das *FetchOrientation* -Argument von **sqlextendecodfetch** ist auf SQL_FETCH_NEXT festgelegt. Der Treiber-Manager verwendet den zwischengespeicherten Wert des SQL_ATTR_ROW_STATUS_PTR Statement-Attributs für das *rowstatus Array* -Argument und den zwischengespeicherten Wert des SQL_ATTR_ROWS_FETCHED_PTR Statement-Attributs für das *rowzähltptr* -Argument.<br />-Eine ODBC *3. x* -Anwendung kann Aufrufe von **SQLFetch** und **SQLFetchScroll** in einem ODBC *2. x* -Treiber mischen, da der ODBC *3. x* -Treiber-Manager **SQLFetch** zu **SQLExtendedFetch** zuordnet, wenn eine Anwendung Sie in einem ODBC *2. x* -Treiber aufruft.<br />Wenn **SQLExtendedFetch** von einem ODBC *2. x* -Treiber nicht unterstützt wird, ordnet der ODBC *3. x* -Treiber-Manager **SQLFetch** oder **SQLFetchScroll** nicht zu **SQLExtendedFetch** zu, wenn es von einer Anwendung in diesem Treiber aufgerufen wird. Wenn die Anwendung versucht, SQL_ATTR_ROW_ARRAY_SIZE auf einen Wert festzulegen, der größer als 1 ist, wird SQLSTATE HYC00 (optionales Feature nicht implementiert) zurückgegeben.<br />(Außer den soeben notierten Einschränkungen übergibt der ODBC *3. x* -Treiber-Manager die Aufrufe von **SQLFetch** unabhängig von der Treiber Version an den Treiber.|  
|**SQLFetchScroll**|Gibt das angegebene Rowset zurück. Im folgenden finden Sie Implementierungsdetails:<br /><br /> : Wenn eine Anwendung **SQLFetchScroll** in einem ODBC *2. x* -Treiber aufruft, ordnet der ODBC *3. x* -Treiber-Manager Sie **SQLExtendedFetch** zu. Er verwendet den zwischengespeicherten Wert des SQL_ATTR_ROW_STATUS_PTR Statement-Attributs für das *rowstatus Array* -Argument und den zwischengespeicherten Wert des SQL_ATTR_ROWS_FETCHED_PTR Statement-Attributs für das *rowzähltptr* -Argument. Wenn das *FetchOrientation* -Argument in **SQLFetchScroll** SQL_FETCH_BOOKMARK ist, wird der zwischengespeicherte Wert des SQL_ATTR_FETCH_BOOKMARK_PTR Statement-Attributs für das *FetchOffset* -Argument verwendet, und es wird ein Fehler zurückgegeben, wenn das *FetchOffset* -Argument von **SQLFetchScroll** nicht 0 ist.<br />Wenn eine Anwendung diese in einem ODBC *3. x* -Treiber aufruft, übergibt der ODBC *3. x* -Treiber-Manager den Aufruf an den Treiber.|  
|**SQLSetPos**|Führt verschiedene positionierte Vorgänge aus. Der ODBC *3. x* -Treiber-Manager übergibt unabhängig von der Treiber Version Aufrufe an **SQLSetPos** an den Treiber.|  
|**SQLSetScrollOptions**|Wenn der Treiber-Manager **SQLSetScrollOptions** für eine Anwendung zuordnet, die mit einem ODBC *3. x* -Treiber arbeitet, der **SQLSetScrollOptions** nicht unterstützt, legt der Treiber-Manager die SQL_ROWSET_SIZE Anweisungs Option, nicht das SQL_ATTR_ROW_ARRAY_SIZE Statement-Attribut, auf das *rowsetsize* -Argument in **sqlsetscrolloption** fest. Daher kann **SQLSetScrollOptions** nicht von einer Anwendung verwendet werden, wenn mehrere Zeilen durch einen-Befehl von **SQLFetch** oder **SQLFetchScroll** abgerufen werden. Diese Option kann nur verwendet werden, wenn mehrere Zeilen durch einen **sqlextendebug**-Befehl abgerufen werden.|
